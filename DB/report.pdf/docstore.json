{"docstore/metadata": {"24ec702d-3a3e-4ecc-91ae-5f5565b37f49": {"doc_hash": "92c80bf4ec82d519de2ef3a04bf9f2904458e006789dff01c7c9f84b1c8c3d81"}, "1950520e-7898-475b-872f-00cceaae10a4": {"doc_hash": "3ac48072a1630bef2d8855687de8cc31cff7a090d1f93c9ab4f5bd5811978f2c"}, "96cc9d5f-e1e5-47f8-9fb5-1d4d3d124872": {"doc_hash": "1296579aa5fd6749b688a67c1cc6629fc36e0b4b9612e9869a5d3ad3b150a8e6"}, "fbae1bf8-7759-478f-989d-fc7464bc878f": {"doc_hash": "c84c7e58fcf96d7c42f0c2473acca307ae2630c83ead87b2d7c498ab85c4a023"}, "30a46f06-e339-489a-b414-a2fed5b799aa": {"doc_hash": "3fb28c1e42fd29b4d7b6f26da3bdf32e87e1d5cb97ce6fa9349a5048603d25b9"}, "71c8c390-795f-463a-b700-e56009a28102": {"doc_hash": "e946db78fa94f8b746b32ef6a33c93a962a79b8dbc3194df5fe33d48ad41879b"}, "6e9131f7-a8b1-46c7-b597-47da9af966f5": {"doc_hash": "db65444a8934412480bdc66560485a56b9d3299a0855f08526a641dd315d992d"}, "23e79bca-5c35-445b-b64d-7349a508cc4f": {"doc_hash": "55c0b53d35bd2ef01a213f2cfc6d021d4387d1ba0241fcb2e466e735e2667a19"}, "93d20018-dc47-4684-8094-7a4df77d224f": {"doc_hash": "92c80bf4ec82d519de2ef3a04bf9f2904458e006789dff01c7c9f84b1c8c3d81", "ref_doc_id": "24ec702d-3a3e-4ecc-91ae-5f5565b37f49"}, "3a513d74-7fcf-4532-89a5-6b579551a6db": {"doc_hash": "3ac48072a1630bef2d8855687de8cc31cff7a090d1f93c9ab4f5bd5811978f2c", "ref_doc_id": "1950520e-7898-475b-872f-00cceaae10a4"}, "1364ae96-3de7-4cf6-b7e6-2583e4a2b93f": {"doc_hash": "1296579aa5fd6749b688a67c1cc6629fc36e0b4b9612e9869a5d3ad3b150a8e6", "ref_doc_id": "96cc9d5f-e1e5-47f8-9fb5-1d4d3d124872"}, "b93062ac-10c6-49b0-9880-9599df483ac7": {"doc_hash": "6b4135521924ce2ef4aeae75fdfc761cfeebd9efe696c7fda13e5b7762a76b08", "ref_doc_id": "fbae1bf8-7759-478f-989d-fc7464bc878f"}, "ba292e0a-b809-43e8-ba61-e787989c3591": {"doc_hash": "528928f76576904c24fbcfcda7fdce458fb8c962360a4719b6d4f9340c32690a", "ref_doc_id": "fbae1bf8-7759-478f-989d-fc7464bc878f"}, "4237e14d-22fa-4d32-a6b0-66cd35d551a9": {"doc_hash": "f0af020e3f27177797daaa826d01402d0331a82525783f3c313f5accfb13964e", "ref_doc_id": "30a46f06-e339-489a-b414-a2fed5b799aa"}, "1955c27a-4d33-4b12-809a-d3e1f718e000": {"doc_hash": "b99900bec7b82cbe664062936b231c249acdc06832f3ded5de55779d86b8e7bf", "ref_doc_id": "30a46f06-e339-489a-b414-a2fed5b799aa"}, "3762edd5-13eb-4fc7-bba4-8565a7fc2165": {"doc_hash": "e946db78fa94f8b746b32ef6a33c93a962a79b8dbc3194df5fe33d48ad41879b", "ref_doc_id": "71c8c390-795f-463a-b700-e56009a28102"}, "4e10ed62-f804-4263-94a2-e4d011ccb19f": {"doc_hash": "db65444a8934412480bdc66560485a56b9d3299a0855f08526a641dd315d992d", "ref_doc_id": "6e9131f7-a8b1-46c7-b597-47da9af966f5"}, "d6af95ea-f1b3-48cb-9ead-d81191d662f0": {"doc_hash": "55c0b53d35bd2ef01a213f2cfc6d021d4387d1ba0241fcb2e466e735e2667a19", "ref_doc_id": "23e79bca-5c35-445b-b64d-7349a508cc4f"}}, "docstore/data": {"93d20018-dc47-4684-8094-7a4df77d224f": {"__data__": {"id_": "93d20018-dc47-4684-8094-7a4df77d224f", "embedding": null, "metadata": {"page_label": "1", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {"1": {"node_id": "24ec702d-3a3e-4ecc-91ae-5f5565b37f49", "node_type": "4", "metadata": {"page_label": "1", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "92c80bf4ec82d519de2ef3a04bf9f2904458e006789dff01c7c9f84b1c8c3d81", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "Building an LLM-Powered Course Query System\nYiyang Ge\nInvitation link: https://huggingface.co/organizations/COS243Yiyang/join/JtWHwgtDcTyMZRUs\nCode Explanation\nThis code de\ufb01nes a Course Query Assistant , an AI-based system that provides information\nabout courses o\ufb00ered in the Spring Semester of 2025. It integrates database operations, SQL gen-\neration, and natural language processing (NLP) with a chatbot interface using Gradio.\nExecution Flow\n1. Database Connection:\n\u2022 The system connects to courses.db and retrieves the schema and data.\n2. User Input:\n\u2022 The user inputs a query through the Gradio interface.\n3. Input Validation:\n\u2022 The input is validated for safety.\n4. SQL Generation:\n\u2022 SQL is generated using the schema and prompt templates.\n5. SQL Validation:\n\u2022 The input is validated for safety.\n6. Query Execution:\n\u2022 The query is executed against the database.\n7. Response Generation:\n\u2022 Results are converted into natural language responses.\n8. Interface Update:\n\u2022 The input and response is displayed in the Gradio chatbot.\n1. Libraries and Environment Setup\n\u2022 Standard Libraries:\n\u2023 os, json, sqlite3 for environment variables, JSON handling, and SQLite database interaction.\n\u2023 pandas for handling tabular data.\n\u2022 LangChain Modules:\n\u2023 Used for LLMs, prompts, and memory management.\n\u2023 Models include ChatOllama, DeepInfra, and ChatOpenAI.\n\u2022 Validation and Safety:\n\u2023 SafeQueryExecutor, InputValidator, and QueryValidator ensure safe and valid user\nqueries.\n\u2022 Gradio:\n1", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1475, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "3a513d74-7fcf-4532-89a5-6b579551a6db": {"__data__": {"id_": "3a513d74-7fcf-4532-89a5-6b579551a6db", "embedding": null, "metadata": {"page_label": "2", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {"1": {"node_id": "1950520e-7898-475b-872f-00cceaae10a4", "node_type": "4", "metadata": {"page_label": "2", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "3ac48072a1630bef2d8855687de8cc31cff7a090d1f93c9ab4f5bd5811978f2c", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "\u2023 Used to create the chatbot\u2019s user interface.\n\u2022 Database Connection:\n\u2023 A connection is established with courses.db to retrieve course information.\n2. LLM and Database Con\ufb01guration\n\u2022 LLM Initialization:\n\u2023 ChatOpenAI is con\ufb01gured with the model gpt-4o-mini.\n\u2022 Database Setup:\n\u2023 The SQLDatabase instance connects to the SQLite database, allowing the schema and queries\nto be executed dynamically.\n\u2022 Environment Variable:\n\u2023 API key for OpenAI is loaded from the environment variable OPENAI_API_KEY.\nconn = sqlite3.connect(\"courses.db\")\n# Local LLM setup\nos.environ[\"OPENAI_API_KEY\"] = str(os.environ.get(\"OPENAI_API_KEY\"))\nllm = ChatOpenAI(model=\"gpt-4o-mini\")\n# Initialize database connection\ndb = SQLDatabase.from_uri(\"sqlite:///courses.db\",\nsample_rows_in_table_info=0)\n3. SQL Query Generation\nPrompts\n\u2022 SQL Prompt Template:\n\u2023 Guides the LLM to generate SQL queries based on the schema and user question.\n\u2023 Includes speci\ufb01c rules for interpreting department-program relationships and handling\ncourse title mismatches.\n\u2023 In fine_tune string\n\u2022 Response Template:\n\u2023 Converts SQL results into human-readable responses.\nFunctions\n\u2022 list_to_string:\n\u2023 Formats a list of items into a grammatically correct string.\n\u2022 get_schema:\n\u2023 Retrieves the schema of the database tables.\n\u2022 parse:\n\u2023 Extracts SQL code from the model\u2019s response.\n\u2022 check_valid_query:\n2", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1345, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "1364ae96-3de7-4cf6-b7e6-2583e4a2b93f": {"__data__": {"id_": "1364ae96-3de7-4cf6-b7e6-2583e4a2b93f", "embedding": null, "metadata": {"page_label": "3", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {"1": {"node_id": "96cc9d5f-e1e5-47f8-9fb5-1d4d3d124872", "node_type": "4", "metadata": {"page_label": "3", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "1296579aa5fd6749b688a67c1cc6629fc36e0b4b9612e9869a5d3ad3b150a8e6", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "\u2023 Ensures generated SQL is valid and safe.\n4. Data Preparation\n\u2022 DataFrame Conversion:\n\u2023 Data from the courses table is loaded into a Pandas DataFrame.\n\u2023 column_unique_values_str\n\u2013 Unique column values are extracted and serialized into a JSON string for inclusion in the\nsystem prompt because the information would be needed for the query in some cases.\n5. Memory and Conversation Management\n\u2022 Conversation Bu\ufb00er Memory:\n\u2023 Retains the context of the conversation for coherent multi-turn interactions.\n\u2022 Prompts with Memory:\n\u2023 Templates updated to incorporate memory, enhancing the LLM\u2019s ability to use historical con-\ntext in responses.\n6. Query Execution and Response\n\u2022 SQL Chain:\n\u2023 Combines schema retrieval, SQL query generation, validation, and execution.\n\u2023 Generates SQL queries\n\u2022 Complete Chain:\n\u2023 Integrates SQL generation, execution, and natural language generation for comprehensive\nquery handling.\n7. Gradio Interface\n\u2022 Interface Components:\n\u2023 Gr.Chatbot: Displays the conversation history.\n\u2023 Gr.Textbox: Accepts user input.\n\u2023 Gr.Button: Submits the input.\n\u2022 Interaction Work\ufb02ow:\n\u2023 User inputs a question.\n\u2023 Query is validated and processed through the chain.\n\u2023 The result is displayed in the chatbot interface.\n8. Fine-Tuning Rules\n\u2022 Custom Logic:\n\u2023 Explicit handling of department-program relationships.\n\u2023 Responses for missing or unrelated course data.\nTest Cases\n3", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1378, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "b93062ac-10c6-49b0-9880-9599df483ac7": {"__data__": {"id_": "b93062ac-10c6-49b0-9880-9599df483ac7", "embedding": null, "metadata": {"page_label": "4", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {"1": {"node_id": "fbae1bf8-7759-478f-989d-fc7464bc878f", "node_type": "4", "metadata": {"page_label": "4", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "c84c7e58fcf96d7c42f0c2473acca307ae2630c83ead87b2d7c498ab85c4a023", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ba292e0a-b809-43e8-ba61-e787989c3591", "node_type": "1", "metadata": {}, "hash": "3c1c922131b4186483e4961f222ed18a1f0b1f4c5cfb7a68db899fd279de6cf2", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "Case 1\nHuman: Which courses are available for the Bachelor of Science in Data Science?\nAssistant: The courses available for the Bachelor of Science in Data Science are:\n1. DAS102 - Introduction to Data Science (3 credits) with prerequisite COS102, taught by Zheng\nQu.\n2. DAS149 - Career Development in Data Science (1 credit), with no prerequisites, taught by var-\nious instructors.\n3. COS205 - Data Structures (4 credits) with prerequisite COS102, taught by Zheng Qu.\n4. DAS241 - Data Visualization (3 credits) with prerequisites COS102, STA101 or COS211, taught\nby Miao Yu.\n5. DAS251 - Data Inference (3 credits) with prerequisites COS102, COS211, taught by Miao Yu.\n6. COS331 - Data Mining (4 credits) with prerequisites MAT201, COS211, DAS241, taught by\nZheng Qu.\n7. COS346 - Big Data Engineering (3 credits) with prerequisites COS205, COS321, taught by Sand\nY. Zhu.\n8. DAS452 - Independent Study for Data Science (2 credits), requires a permission form, taught\nby various instructors.\n9. DAS491 - Senior Project (4 credits), requires a permission form, taught by various instructors.\nHuman: Who is teaching the \ufb01rst course on the list?\nAssistant: The instructor teaching the \ufb01rst course on the list, \u201cIntroduction to Data Science, \u201d is\nZheng Qu.\nCase 2\nHuman: Which courses are available in the Data Science department for Spring 2025?\u201d\nAssistant: The following courses are available in the Data Science department for Spring 2025:\n1. DAS102 - Introduction to Data Science (3 credits), Instructor: Zheng Qu, Format: Lecture,\nSchedule: Monday and Wednesday from 14:15 to 15:30.\n2. DAS149 - Career Development in Data Science (1 credit), Instructor: Varies, Format: Lecture,\nSchedule: Tuesday from 19:00 to 20:30.\n3. COS205 - Data Structures (4 credits), Instructor: Zheng Qu, Format: Lecture, Schedule: Mon-\nday and Tuesday from 10:00 to 11:10; Wednesday from 10:00 to 11:00.\n4.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1882, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "ba292e0a-b809-43e8-ba61-e787989c3591": {"__data__": {"id_": "ba292e0a-b809-43e8-ba61-e787989c3591", "embedding": null, "metadata": {"page_label": "4", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {"1": {"node_id": "fbae1bf8-7759-478f-989d-fc7464bc878f", "node_type": "4", "metadata": {"page_label": "4", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "c84c7e58fcf96d7c42f0c2473acca307ae2630c83ead87b2d7c498ab85c4a023", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b93062ac-10c6-49b0-9880-9599df483ac7", "node_type": "1", "metadata": {"page_label": "4", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "6b4135521924ce2ef4aeae75fdfc761cfeebd9efe696c7fda13e5b7762a76b08", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "Case 2\nHuman: Which courses are available in the Data Science department for Spring 2025?\u201d\nAssistant: The following courses are available in the Data Science department for Spring 2025:\n1. DAS102 - Introduction to Data Science (3 credits), Instructor: Zheng Qu, Format: Lecture,\nSchedule: Monday and Wednesday from 14:15 to 15:30.\n2. DAS149 - Career Development in Data Science (1 credit), Instructor: Varies, Format: Lecture,\nSchedule: Tuesday from 19:00 to 20:30.\n3. COS205 - Data Structures (4 credits), Instructor: Zheng Qu, Format: Lecture, Schedule: Mon-\nday and Tuesday from 10:00 to 11:10; Wednesday from 10:00 to 11:00.\n4. DAS241 - Data Visualization (3 credits), Instructor: Miao Yu, Format: Lecture, Schedule:\nWednesday from 10:00 to 11:15.\n5. DAS251 - Data Inference (3 credits), Instructor: Miao Yu, Format: Lecture, Schedule: Tuesday\nand Thursday from 14:15 to 15:30.\n6. COS331 - Data Mining (4 credits), Instructor: Zheng Qu, Format: Lecture, Schedule: Monday,\nTuesday, and Wednesday from 14:15 to 15:30.\n7. COS346 - Big Data Engineering (3 credits), Instructor: Sand Y. Zhu, Format: Lecture, Sched-\nule: Tuesday and Thursday from 08:30 to 09:45.\n4", "mimetype": "text/plain", "start_char_idx": 1251, "end_char_idx": 2414, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "4237e14d-22fa-4d32-a6b0-66cd35d551a9": {"__data__": {"id_": "4237e14d-22fa-4d32-a6b0-66cd35d551a9", "embedding": null, "metadata": {"page_label": "5", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {"1": {"node_id": "30a46f06-e339-489a-b414-a2fed5b799aa", "node_type": "4", "metadata": {"page_label": "5", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "3fb28c1e42fd29b4d7b6f26da3bdf32e87e1d5cb97ce6fa9349a5048603d25b9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "1955c27a-4d33-4b12-809a-d3e1f718e000", "node_type": "1", "metadata": {}, "hash": "39ccffba312d65f987d4e0f1235b4b544b3cc7eb28400a1b08bf0ac38bbfe33e", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "8. DAS452 - Independent Study for Data Science (2 credits), Instructor: Varies, Format: Inde-\npendent Study.\n9. DAS491 - Senior Project (4 credits), Instructor: Varies, Format: Independent Study.\n10. DAS501 - Mathematical Foundation for Data Science (3 credits, online), Instructor: Miao Yu.\n11. COS501 - Computational Foundation for Data Science (3 credits, online), Instructor: Zheng\nQu.\n12. DAS502 - Probability for Data Science (3 credits, online), Instructor: Miao Yu.\n13. DAS522 - Exploratory Data Analysis and Visualization (3 credits), Instructor: Miao Yu, For-\nmat: Lecture/Lab, Schedule: Monday and Wednesday from 08:30 to 10:30.\n14. COS531 - Modern Applied Statistical Learning (3 credits), Instructor: Miao Yu.\n15. DAS541 - Data Mining for Business (3 credits), Instructor: Zheng Qu.\n16. COS541 - Big Data and Data Engineering (3 credits), Instructor: Sand Y. Zhu, Format: Lecture/\nLab, Schedule: Tuesday and Thursday from 14:00 to 16:00.\n17. STA421 - Design and Analysis of Experiments (3 credits), Instructor: Zhanglin Cui.\n18. STA521 - Design and Analysis of Experiments (3 credits), Instructor: Zhanglin Cui.\n19. COS643 - Computer Vision and Natural Language Processing (3 credits, Independent Study),\nInstructor: Zheng Qu.\n20. DAS761 - Capstone Project (6 credits), Instructor: Varies, Format: Independent Study.\nThese courses cover a range of topics and formats, including both in-person and online options.\nCase 3\nHuman: What are the details of the course \u2018Introduction to Python\u2019?\nAssistant: I\u2019m sorry, but there is no information found regarding the course \u2018Introduction to\nPython\u2019 in the provided data.\n(There is no python course in this csv \ufb01le)\nCase 4\nHuman: How many courses are o\ufb00ered under the Computer Science (Bachelor of Science) pro-\ngram?\nAssistant: There are three courses o\ufb00ered under the Computer Science (Bachelor of Science) pro-\ngram.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1872, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "1955c27a-4d33-4b12-809a-d3e1f718e000": {"__data__": {"id_": "1955c27a-4d33-4b12-809a-d3e1f718e000", "embedding": null, "metadata": {"page_label": "5", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {"1": {"node_id": "30a46f06-e339-489a-b414-a2fed5b799aa", "node_type": "4", "metadata": {"page_label": "5", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "3fb28c1e42fd29b4d7b6f26da3bdf32e87e1d5cb97ce6fa9349a5048603d25b9", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "4237e14d-22fa-4d32-a6b0-66cd35d551a9", "node_type": "1", "metadata": {"page_label": "5", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "f0af020e3f27177797daaa826d01402d0331a82525783f3c313f5accfb13964e", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "STA521 - Design and Analysis of Experiments (3 credits), Instructor: Zhanglin Cui.\n19. COS643 - Computer Vision and Natural Language Processing (3 credits, Independent Study),\nInstructor: Zheng Qu.\n20. DAS761 - Capstone Project (6 credits), Instructor: Varies, Format: Independent Study.\nThese courses cover a range of topics and formats, including both in-person and online options.\nCase 3\nHuman: What are the details of the course \u2018Introduction to Python\u2019?\nAssistant: I\u2019m sorry, but there is no information found regarding the course \u2018Introduction to\nPython\u2019 in the provided data.\n(There is no python course in this csv \ufb01le)\nCase 4\nHuman: How many courses are o\ufb00ered under the Computer Science (Bachelor of Science) pro-\ngram?\nAssistant: There are three courses o\ufb00ered under the Computer Science (Bachelor of Science) pro-\ngram.\n(This is correct, there are 3 courses under the department Computer Science (CS), Computer\nNetworks and Cybersecurity (CNCS),and this department doesn\u2019t have pragram under it)\nCase 5\nHuman: Show me the courses taught by Dr.\u00a0Qu in Spring 2025\nAssistant: Dr.\u00a0Zheng Qu teaches the following courses in Spring 2025:\n1. Introduction to Data Science (DAS102)  - 3 credits, with a prerequisite of COS102, o\ufb00ered\non Monday and Wednesday from 2:15 PM to 3:30 PM. This course is part of the Data Science\nBachelor of Science program.\n5", "mimetype": "text/plain", "start_char_idx": 1042, "end_char_idx": 2397, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "3762edd5-13eb-4fc7-bba4-8565a7fc2165": {"__data__": {"id_": "3762edd5-13eb-4fc7-bba4-8565a7fc2165", "embedding": null, "metadata": {"page_label": "6", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {"1": {"node_id": "71c8c390-795f-463a-b700-e56009a28102", "node_type": "4", "metadata": {"page_label": "6", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "e946db78fa94f8b746b32ef6a33c93a962a79b8dbc3194df5fe33d48ad41879b", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "2. Data Structures (COS205) - 4 credits, with a prerequisite of COS102, o\ufb00ered on Monday and\nTuesday from 10:00 AM to 11:10 AM. This course is also part of the Data Science Bachelor of\nScience program.\n3. Data Mining (COS331) - 4 credits, with prerequisites of MAT201, COS211, and DAS241, of-\nfered on Monday and Wednesday from 2:15 PM to 3:30 PM. This course is part of the Data\nScience Bachelor of Science program.\n4. Computational Foundation for Data Science (COS501) - 3 credits, no prerequisites, o\ufb00ered\nonline. This course is part of the Data Science Master of Science program.\n5. Data Mining for Business (DAS541) - 3 credits, with prerequisites of DAS501 and COS501,\no\ufb00ered on Tuesday and Wednesday from 2:15 PM to 3:30 PM. This course is part of the Data\nScience Master of Science program.\n6. Computer Vision and Natural Language Processing (COS643) - 3 credits, with a prereq-\nuisite of COS536, o\ufb00ered as an independent study. This course is part of the Data Science Mas-\nter of Science program.\nCase 6\nHuman: What are the details of the course introduction to statistic?\nAssistant: The course \u201cIntroduction to Statistics\u201d is listed with the following details:\n\u2022 Course Code: STA101\n\u2022 Credits: 3.0\n\u2022 Prerequisites: None\n\u2022 Instructor: Michael Zhao\n\u2022 Major/GE/Elective: It is categorized under both \u201cSTA-Y1\u201d and \u201cGeneral Education (GE)\u201d.\n\u2022 Format: Lecture\n\u2022 Schedule:\n\u2023 Tuesday from 10:00 AM to 11:15 AM\n\u2023 Wednesday from 10:00 AM to 11:15 AM\n\u2022 Room: D323\n\u2022 Department: Applied Math & Statistics\n\u2022 Program: Bachelor of Science.\nCase 7\nHuman: Make the table disappear.\nAssistant: I apologize, but I cannot provide an answer due to the lack of information regarding\nhow to make the table disappear.\nProblems and Solutions\n1. Unable to generate correct SQL Due to Lack of information\nFor example\n6", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1801, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "4e10ed62-f804-4263-94a2-e4d011ccb19f": {"__data__": {"id_": "4e10ed62-f804-4263-94a2-e4d011ccb19f", "embedding": null, "metadata": {"page_label": "7", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {"1": {"node_id": "6e9131f7-a8b1-46c7-b597-47da9af966f5", "node_type": "4", "metadata": {"page_label": "7", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "db65444a8934412480bdc66560485a56b9d3299a0855f08526a641dd315d992d", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "question = \"Which courses are available in the Biomedical sciemce department for\nSpring 2025?\"\nsql = sql_generator.invoke({\"question\": question})\nprint(str(sql))\nThis code will retrun\nSELECT * FROM courses WHERE \"Department\" = 'Biomedical Science';\nBut the actual Department value is Biomedical Science (BMS)\nSolution\nPut needed information in to system prompt\ncolumn_unique_values_stris storing Needed Instructor, Department, Programs information,\nCourse titles\n{\"Instructor\": [\"Michael Zhao\", \"Kevin Ren\", \"Qihu ...... or of Fine Arts)\",\n\"Dance (Master of Fine Arts)\"]}\nsystem_prompt = \"\"\"Your are an helpful assistence that helps answer questions\nabout course on Spring Semeter of 2025. \\\n                All needed information is stored in course.db\n                Here is a dictionary storing something values of the database. \n                The key of dictionary is Column name, and the value is a list\nof values of the database under the corresponding Column name\n                \n                Dictionary : \\n\n                \"\"\"+column_unique_values_str[1:-2]\n2. SQL validation error\nInput SQL:\nSELECT COUNT(*) \nFROM courses \nWHERE \"Instructor\" = 'Michael Zhao';\nBut got error:\n{'success': False, 'error': ['Multiple SQL statements are not allowed'], 'query':\n'\\nSELECT COUNT(*) \\nFROM courses \\nWHERE \"Instructor\" = \\'Michael Zhao\\';\\n',\n'result': None}\n7", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 1370, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "d6af95ea-f1b3-48cb-9ead-d81191d662f0": {"__data__": {"id_": "d6af95ea-f1b3-48cb-9ead-d81191d662f0", "embedding": null, "metadata": {"page_label": "8", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "excluded_embed_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "excluded_llm_metadata_keys": ["file_name", "file_type", "file_size", "creation_date", "last_modified_date", "last_accessed_date"], "relationships": {"1": {"node_id": "23e79bca-5c35-445b-b64d-7349a508cc4f", "node_type": "4", "metadata": {"page_label": "8", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}, "hash": "55c0b53d35bd2ef01a213f2cfc6d021d4387d1ba0241fcb2e466e735e2667a19", "class_name": "RelatedNodeInfo"}}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "Solution\nThe cause of the problem is the space at the end of querys. It makes the code below can\u2019t detect\nproperly. Use strip() method would solve the problem\nif ';' in sql.strip()[:-1]:  # Allow semicolon at the end\n    self.error_messages.append(\"Multiple SQL statements are not allowed\")\n    return False\n3. Query return no result\nMy question is what courses are available for the Bachelor of Science in Data Science? The SQL\nstatement is what LLM returns.\nSELECT * \nFROM courses \nWHERE \"Program\" = '(Bachelor of Science)' AND \"Department\" = 'Data Science\n(Bachelor of Science)';\nThe problem is that \u2018(Bachelor of Science)\u2019 and Data Science (Bachelor of Science) are all programs.\nThe di\ufb00erence is that they belongs to di\ufb00erent Department, however, the modal can\u2019t distinguish\nbetween them.\nSolution\nSpecify the di\ufb00erence in the system prompt at the beginning.\n8", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 865, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}}, "docstore/ref_doc_info": {"24ec702d-3a3e-4ecc-91ae-5f5565b37f49": {"node_ids": ["93d20018-dc47-4684-8094-7a4df77d224f"], "metadata": {"page_label": "1", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}}, "1950520e-7898-475b-872f-00cceaae10a4": {"node_ids": ["3a513d74-7fcf-4532-89a5-6b579551a6db"], "metadata": {"page_label": "2", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}}, "96cc9d5f-e1e5-47f8-9fb5-1d4d3d124872": {"node_ids": ["1364ae96-3de7-4cf6-b7e6-2583e4a2b93f"], "metadata": {"page_label": "3", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}}, "fbae1bf8-7759-478f-989d-fc7464bc878f": {"node_ids": ["b93062ac-10c6-49b0-9880-9599df483ac7", "ba292e0a-b809-43e8-ba61-e787989c3591"], "metadata": {"page_label": "4", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}}, "30a46f06-e339-489a-b414-a2fed5b799aa": {"node_ids": ["4237e14d-22fa-4d32-a6b0-66cd35d551a9", "1955c27a-4d33-4b12-809a-d3e1f718e000"], "metadata": {"page_label": "5", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}}, "71c8c390-795f-463a-b700-e56009a28102": {"node_ids": ["3762edd5-13eb-4fc7-bba4-8565a7fc2165"], "metadata": {"page_label": "6", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}}, "6e9131f7-a8b1-46c7-b597-47da9af966f5": {"node_ids": ["4e10ed62-f804-4263-94a2-e4d011ccb19f"], "metadata": {"page_label": "7", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}}, "23e79bca-5c35-445b-b64d-7349a508cc4f": {"node_ids": ["d6af95ea-f1b3-48cb-9ead-d81191d662f0"], "metadata": {"page_label": "8", "file_name": "report.pdf", "file_path": "upload\\report.pdf", "file_type": "application/pdf", "file_size": 93082, "creation_date": "2024-12-20", "last_modified_date": "2024-12-20"}}}}